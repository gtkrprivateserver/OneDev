<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ONEDEV - Monitor Bot</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="monitor.css">
</head>
<body>
  <!-- SIDEBAR -->
  <aside class="sidebar" id="sidebar">
    <h2 class="logo">ONE<span>DEV</span></h2>
    <nav>
      <a href="index.html">üè† Home</a>
      <a href="about.html">üí° About</a>
      <a href="services.html">‚öôÔ∏è Services</a>
      <a href="monitor.html" class="active">‚è≥ Monitor</a>
      <a href="contact.html">üì© Contact</a>
    </nav>
    <footer>¬© 2025 ONEDEV</footer>
  </aside>

  <!-- MAIN CONTENT -->
  <div class="main-content">
    <header>
      <div class="header-left">
        <button class="menu-btn" id="menuBtn">‚ò∞</button>
        <h1>Monitor Bot</h1>
      </div>
    </header>

    <section class="monitor-section">
      <h2>Monitor Status Discord Bot üöÄ</h2>
      <p>Status realtime: 
        <span style="color:#00ff85;">Online ‚úÖ</span>, 
        <span style="color:#ff4c4c;">Offline ‚ùå</span>, 
        <span style="color:#ffb300;">Disconnected ‚ö†Ô∏è</span>
      </p>
      <div class="monitor-grid" id="monitorGrid"></div>
    </section>
  </div>

  <script>
    // Sidebar toggle
    const menuBtn = document.getElementById('menuBtn');
    const sidebar = document.getElementById('sidebar');
    menuBtn.addEventListener('click', () => sidebar.classList.toggle('active'));

    // Discord bot list
    const bots = [
      { name: "Main Bot", id: "BOT_ID_1" },
      { name: "Helper Bot", id: "BOT_ID_2" },
      { name: "Music Bot", id: "BOT_ID_3" },
      { name: "Fun Bot", id: "BOT_ID_4" },
      { name: "Moderation Bot", id: "BOT_ID_5" }
    ];

    const monitorGrid = document.getElementById("monitorGrid");

    function createCard(bot){
      const div = document.createElement("div");
      div.classList.add("monitor-card","disconnected");
      div.innerHTML = `
        <h3>${bot.name}</h3>
        <p>Status: <span>Disconnected ‚ö†Ô∏è</span></p>
        <div class="details">
          <p>Server Count: 0</p>
          <p>Ping: N/A</p>
          <p>Last Heartbeat: N/A</p>
        </div>
      `;
      return div;
    }

    bots.forEach(bot => monitorGrid.appendChild(createCard(bot)));

    // Fetch bot status from API
    async function updateBotStatus(){
      try{
        const res = await fetch("/bot-status"); // backend API
        const data = await res.json();

        const cards = document.querySelectorAll(".monitor-card");
        cards.forEach((card,i)=>{
          const botData = data[i];
          card.classList.remove("online","offline","disconnected");

          if(!botData || !botData.status){
            card.classList.add("disconnected");
            card.querySelector("p span").innerText="Disconnected ‚ö†Ô∏è";
          } else if(botData.status==="online"){
            card.classList.add("online");
            card.querySelector("p span").innerText="Online ‚úÖ";
          } else {
            card.classList.add("offline");
            card.querySelector("p span").innerText="Offline ‚ùå";
          }

          // Update details
          const details = card.querySelector(".details");
          details.innerHTML = `
            <p>Server Count: ${botData?.servers || 0}</p>
            <p>Ping: ${botData?.ping || "N/A"} ms</p>
            <p>Last Heartbeat: ${botData?.lastHeartbeat || "N/A"}</p>
          `;
        });
      }catch(err){
        const cards = document.querySelectorAll(".monitor-card");
        cards.forEach(card=>{
          card.classList.remove("online","offline");
          card.classList.add("disconnected");
          card.querySelector("p span").innerText="Disconnected ‚ö†Ô∏è";
          card.querySelector(".details").innerHTML = `
            <p>Server Count: 0</p>
            <p>Ping: N/A</p>
            <p>Last Heartbeat: N/A</p>
          `;
        });
      }
    }

    updateBotStatus();
    setInterval(updateBotStatus,5000);
  </script>
</body>
</html>
